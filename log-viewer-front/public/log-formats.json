{
  "formats": [
    {
      "id": "apache-error",
      "name": "Apache Error Log",
      "description": "Apache HTTP Server error log format",
      "priority": 100,
      "patterns": [
        "^\\[(?<timestamp>.*?)\\] \\[(?<level>[a-z]+)\\](?: \\[client (?<client>[^\\]]+)\\])?(?: (?<message>.*))?$"
      ],
      "fields": [
        {
          "name": "timestamp",
          "description": "Log entry timestamp",
          "type": "datetime"
        },
        {
          "name": "level",
          "description": "Log severity level (error, warn, info, etc.)",
          "type": "string"
        },
        {
          "name": "client",
          "description": "Client IP address and port",
          "type": "string",
          "optional": true
        },
        {
          "name": "message",
          "description": "Error message text",
          "type": "string"
        }
      ]
    },
    {
      "id": "hdfs-v2",
      "name": "HDFS v2",
      "description": "Hadoop HDFS version 2 log format (YYYY-MM-DD HH:MM:SS,mmm)",
      "priority": 90,
      "patterns": [
        "^(?<timestamp>\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2},\\d{3}) (?<level>INFO|WARN|ERROR|DEBUG|TRACE|FATAL) (?<class>[\\w.$:-]+): ?(?<message>.*)"
      ],
      "fields": [
        {
          "name": "timestamp",
          "description": "Timestamp in format YYYY-MM-DD HH:MM:SS,mmm",
          "type": "datetime"
        },
        {
          "name": "level",
          "description": "Log level (INFO, WARN, ERROR, DEBUG, TRACE, FATAL)",
          "type": "string"
        },
        {
          "name": "class",
          "description": "Java class name",
          "type": "string"
        },
        {
          "name": "message",
          "description": "Log message content",
          "type": "string"
        }
      ]
    },
    {
      "id": "hdfs-v1",
      "name": "HDFS v1",
      "description": "Hadoop HDFS version 1 log format (yyMMdd HHmmss)",
      "priority": 85,
      "patterns": [
        "^(?<date>\\d{6}) (?<time>\\d{6}) (?<thread>\\d+) (?<level>[A-Z]+) (?<class>[\\w.$:-]+): ?(?<message>.*)"
      ],
      "fields": [
        {
          "name": "date",
          "description": "Date in format yyMMdd",
          "type": "date"
        },
        {
          "name": "time",
          "description": "Time in format HHmmss",
          "type": "time"
        },
        {
          "name": "thread",
          "description": "Thread ID",
          "type": "number"
        },
        {
          "name": "level",
          "description": "Log level",
          "type": "string"
        },
        {
          "name": "class",
          "description": "Java class name",
          "type": "string"
        },
        {
          "name": "message",
          "description": "Log message content",
          "type": "string"
        }
      ]
    },
    {
      "id": "bgl-new",
      "name": "BGL (New)",
      "description": "Blue Gene/L new format with structured job information",
      "priority": 80,
      "patterns": [
        "^(?<timestamp>\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}) JOB (?<jobId>\\d+) USER=(?<user>\\w+) QUEUE=(?<queue>\\w+) NODES=(?<nodes>\\d+) CORES=(?<cores>\\d+) RUNTIME=(?<runtime>\\d{2}:\\d{2}:\\d{2}) STATUS=(?<status>\\w+)"
      ],
      "fields": [
        {
          "name": "timestamp",
          "description": "Job event timestamp",
          "type": "datetime"
        },
        {
          "name": "jobId",
          "description": "Unique job identifier",
          "type": "number"
        },
        {
          "name": "user",
          "description": "Username who submitted the job",
          "type": "string"
        },
        {
          "name": "queue",
          "description": "Queue name (e.g., low, normal, high)",
          "type": "string"
        },
        {
          "name": "nodes",
          "description": "Number of compute nodes allocated",
          "type": "number"
        },
        {
          "name": "cores",
          "description": "Total number of CPU cores used",
          "type": "number"
        },
        {
          "name": "runtime",
          "description": "Job runtime in HH:MM:SS format",
          "type": "duration"
        },
        {
          "name": "status",
          "description": "Job completion status (COMPLETED, CANCELLED, FAILED)",
          "type": "string"
        }
      ]
    },
    {
      "id": "bgl-old",
      "name": "BGL (Old)",
      "description": "Blue Gene/L old format with timestamp",
      "priority": 75,
      "patterns": [
        "(?<timestamp>\\d{4}-\\d{2}-\\d{2}-\\d{2}\\.\\d{2}\\.\\d{2}\\.\\d{6})"
      ],
      "fields": [
        {
          "name": "timestamp",
          "description": "Timestamp in format YYYY-MM-DD-HH.MM.SS.microseconds",
          "type": "datetime"
        }
      ]
    },
    {
      "id": "nginx",
      "name": "Nginx",
      "description": "Nginx web server access log",
      "priority": 70,
      "patterns": [
        "^(?<ip>\\S+) - (?<user>\\S+) \\[(?<timestamp>\\d{2}\\/\\w{3}\\/\\d{4}:\\d{2}:\\d{2}:\\d{2} [+-]\\d{4})\\] \"(?<method>\\w+) (?<path>\\S+) (?<protocol>HTTP\\/[\\d.]+)\" (?<status>\\d{3}) (?<bytes>\\d+) \"(?<referer>[^\"]*)\" \"(?<userAgent>[^\"]*)\""
      ],
      "additionalCheck": "nginx",
      "fields": [
        {
          "name": "ip",
          "description": "Client IP address",
          "type": "string"
        },
        {
          "name": "user",
          "description": "Authenticated username (or - if none)",
          "type": "string"
        },
        {
          "name": "timestamp",
          "description": "Request timestamp with timezone",
          "type": "datetime"
        },
        {
          "name": "method",
          "description": "HTTP method (GET, POST, etc.)",
          "type": "string"
        },
        {
          "name": "path",
          "description": "Request URI path",
          "type": "string"
        },
        {
          "name": "protocol",
          "description": "HTTP protocol version",
          "type": "string"
        },
        {
          "name": "status",
          "description": "HTTP response status code",
          "type": "number"
        },
        {
          "name": "bytes",
          "description": "Response size in bytes",
          "type": "number"
        },
        {
          "name": "referer",
          "description": "HTTP referer header",
          "type": "string"
        },
        {
          "name": "userAgent",
          "description": "Client user agent string",
          "type": "string"
        }
      ]
    },
    {
      "id": "apache-access",
      "name": "Apache Access Log",
      "description": "Apache HTTP Server access log (Common Log Format)",
      "priority": 65,
      "patterns": [
        "^(?<ip>\\S+) (?<ident>\\S+) (?<user>(?!-)\\S+) \\[(?<timestamp>\\d{2}\\/\\w{3}\\/\\d{4}:\\d{2}:\\d{2}:\\d{2} [+-]\\d{4})\\] \"(?<method>\\w+) (?<path>\\S+) (?<protocol>HTTP\\/[\\d.]+)\" (?<status>\\d{3}) (?<bytes>\\d+)"
      ],
      "fields": [
        {
          "name": "ip",
          "description": "Client IP address",
          "type": "string"
        },
        {
          "name": "ident",
          "description": "Client identity (RFC 1413)",
          "type": "string"
        },
        {
          "name": "user",
          "description": "Authenticated username",
          "type": "string"
        },
        {
          "name": "timestamp",
          "description": "Request timestamp with timezone",
          "type": "datetime"
        },
        {
          "name": "method",
          "description": "HTTP method (GET, POST, etc.)",
          "type": "string"
        },
        {
          "name": "path",
          "description": "Request URI path",
          "type": "string"
        },
        {
          "name": "protocol",
          "description": "HTTP protocol version",
          "type": "string"
        },
        {
          "name": "status",
          "description": "HTTP response status code",
          "type": "number"
        },
        {
          "name": "bytes",
          "description": "Response size in bytes",
          "type": "number"
        }
      ]
    },
    {
      "id": "syslog",
      "name": "Syslog",
      "description": "Standard Unix/Linux syslog format",
      "priority": 60,
      "patterns": [
        "^(?<month>\\w{3}) +(?<day>\\d{1,2}) (?<time>\\d{2}:\\d{2}:\\d{2}) (?<hostname>\\S+) (?<process>\\S+?)(?:\\[(?<pid>\\d+)\\])?: ?(?<message>.*)"
      ],
      "fields": [
        {
          "name": "month",
          "description": "Month abbreviation (Jan, Feb, etc.)",
          "type": "string"
        },
        {
          "name": "day",
          "description": "Day of month",
          "type": "number"
        },
        {
          "name": "time",
          "description": "Time in HH:MM:SS format",
          "type": "time"
        },
        {
          "name": "hostname",
          "description": "Hostname or IP of the logging machine",
          "type": "string"
        },
        {
          "name": "process",
          "description": "Process or daemon name",
          "type": "string"
        },
        {
          "name": "pid",
          "description": "Process ID",
          "type": "number",
          "optional": true
        },
        {
          "name": "message",
          "description": "Log message content",
          "type": "string"
        }
      ]
    },
    {
      "id": "web-access-generic",
      "name": "Web Access Log",
      "description": "Generic web server access log format",
      "priority": 50,
      "patterns": [
        "^(?<ip>\\S+) - (?<user>\\S+) \\[(?<timestamp>\\d{2}\\/\\w{3}\\/\\d{4}:\\d{2}:\\d{2}:\\d{2} [+-]\\d{4})\\]"
      ],
      "fields": [
        {
          "name": "ip",
          "description": "Client IP address",
          "type": "string"
        },
        {
          "name": "user",
          "description": "Username (or - if none)",
          "type": "string"
        },
        {
          "name": "timestamp",
          "description": "Request timestamp",
          "type": "datetime"
        }
      ]
    }
  ]
}
